<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="../css/styles.css">
    <title>Plannea</title>
</head>
<body>
    <header class="main-header">
        <img src="../images/PLANNEA.png" alt="Plannea Logo" class="logo">
        <button id="btnSettings" class="settings-button" aria-label="Settings">⚙️</button>
    </header>
    <div id="toast" class="toast" hidden aria-live="polite"></div>
    <div style="padding:1rem;">
      <input id="searchInput" type="search" placeholder="Buscar eventos por nombre..." style="width:100%; padding:.6rem; border-radius:8px; border:1px solid #e6dbf5; margin-bottom:1rem;" />
    </div>
    <div id="toast" class="toast" hidden aria-live="polite"></div>
        <!-- CONFIRMATION MODAL -->
        <div id="confirmModal" class="modal" hidden>
            <div class="modal-backdrop" data-close="confirm-modal"></div>
            <div class="modal-card" role="dialog" aria-modal="true" aria-labelledby="confirmTitle">
                <h2 id="confirmTitle">Confirmar</h2>
                <p id="confirmMessage">¿Estás seguro?</p>
                <div style="display:flex; gap:.5rem; justify-content:flex-end; margin-top:.8rem;">
                    <button id="confirmCancel" class="ghost">Cancelar</button>
                    <button id="confirmOk" class="primary">Confirmar</button>
                </div>
            </div>
        </div>
    <!-- search-bar removed (we use #searchInput above) -->
    <main class="events-list" id="eventsContainer">
        <!-- Eventos renderizados dinámicamente desde js/events.js -->
    </main>
<!-- PURCHASE MODAL (same as index) -->
<div id="purchaseModal" class="modal" hidden>
    <div class="modal-backdrop" data-close="purchase-modal"></div>
    <div class="modal-card" role="dialog" aria-modal="true" aria-labelledby="purchaseTitle">
        <button class="modal-close" data-close="purchase-modal" aria-label="Cerrar">✕</button>
        <h2 id="purchaseTitle">Comprar entrada</h2>
        <div style="display:grid; gap:.6rem;">
            <div><strong id="purchaseEventName"></strong></div>
            <label>Cantidad
                <select id="purchaseQty"><option>1</option><option>2</option><option>3</option><option>4</option></select>
            </label>
            <label>Tu nombre
                <input id="purchaseBuyer" type="text" placeholder="Nombre" />
            </label>
      <div id="purchaseTotal" style="font-weight:700; margin-top:.25rem">Total: -</div>
      <div style="display:flex; gap:.5rem; justify-content:flex-end;">
                <button id="purchaseCancel" class="ghost">Cancelar</button>
                <button id="purchaseConfirm" class="primary">Confirmar compra</button>
            </div>
        </div>
    </div>
</div>
<nav class="bottom-nav">
  <a href="../index.html" class="nav-item active" aria-label="Events">
    <!-- Ticket (minimal) -->
    <svg class="nav-icon" viewBox="0 0 24 24" width="22" height="22" fill="none" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round">
      <path d="M3 7h18v4a2 2 0 0 1-2 2 2 2 0 1 0 0 4v4H3v-4a2 2 0 1 0 0-4V7z"/>
    </svg>
    <span class="nav-text">Events</span>
  </a>
  <a href="../pages/agenda.html" class="nav-item" aria-label="Agenda">
    <!-- Calendar -->
    <svg class="nav-icon" viewBox="0 0 24 24" width="22" height="22" fill="none" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round">
      <rect x="3" y="5" width="18" height="16" rx="2"/><path d="M16 3v4M8 3v4M3 11h18"/>
    </svg>
    <span class="nav-text">Agenda</span>
  </a>
  <a href="../pages/notificaciones.html" class="nav-item" aria-label="Notifications">
    <!-- Bell -->
    <svg class="nav-icon" viewBox="0 0 24 24" width="22" height="22" fill="none" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round">
      <path d="M18 8a6 6 0 1 0-12 0c0 7-3 7-3 9h18c0-2-3-2-3-9"/><path d="M13.73 21a2 2 0 0 1-3.46 0"/>
    </svg>
    <span class="nav-text">Notifications</span>
  </a>
</nav>
<script src="../js/events.js"></script>
<script>
  (function(){
    const container = document.getElementById('eventsContainer');
  const events = (window.getPlanneaEventsState && window.getPlanneaEventsState()) || window.planneaEvents || [];
    if(!container) return;
    events.forEach(ev => {
      const card = document.createElement('div'); card.className = 'event-card';
  const img = document.createElement('img'); img.className = 'event-image'; img.src = '../images/' + (ev.img || 'placeholder.jpg'); img.alt = ev.nombre || '';
  // make image link to detail too
  const imgLink = document.createElement('a'); imgLink.href = './event.html?slug=' + encodeURIComponent(ev.slug || ''); imgLink.appendChild(img);
      const details = document.createElement('div'); details.className = 'event-details';
  const h = document.createElement('h3'); h.className = 'event-title';
  const a = document.createElement('a'); a.href = './event.html?slug=' + encodeURIComponent(ev.slug || ''); a.textContent = ev.nombre || '';
  h.appendChild(a);
  const p = document.createElement('p'); p.className = 'event-date'; p.textContent = ev.date || '';
  const avail = document.createElement('p'); avail.className = 'event-available'; avail.textContent = 'Disponibles: ' + (ev.available || 0);
  const btn = document.createElement('button'); btn.className = 'buy-button'; btn.textContent = 'Comprar Ticket'; btn.setAttribute('data-event', ev.nombre || '');
  details.appendChild(h); details.appendChild(p); details.appendChild(avail); details.appendChild(btn);
  card.appendChild(imgLink); card.appendChild(details);
      container.appendChild(card);
    });
  })();
</script>
<script src="../js/app.js"></script>
</body>
</html>